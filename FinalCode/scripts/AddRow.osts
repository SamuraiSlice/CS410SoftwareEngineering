{"version":"0.3.0","body":"\nfunction main(workbook: ExcelScript.Workbook,password : string, clearAndAdd : string, inputData: string[]) {\n    // Access the first worksheet in the workbook\n    let inputSheet = workbook.getWorksheet(\"input\");\n\n    // Check if the sheet is protected and unprotect it if necessary\n    if (inputSheet.getProtection().getProtected()) {\n            try {\n                inputSheet.getProtection().unprotect(password || \"\");\n                console.log(\"Sheet was protected, now unprotected.\");\n            } catch (error) {\n                console.log(\"Failed to unprotect the sheet. Please check if the password is correct.\");\n            }\n    }\n\n    // Reference the table by its name. Replace \"MyTable\" with your actual table name.\n    let table = inputSheet.getTable(\"InputValues\");\n\n    // Check if the clearAndAdd flag is \"Clear\", and delete all rows in the table\n    if (clearAndAdd === \"Clear\") {\n        // Get the row count of the table\n        let rowCount = table.getRowCount();\n\n        // Delete rows in reverse order to avoid shifting issues\n        for (let i = rowCount - 1; i > 0; i--) {\n            let rowAddress = table.getRange().getRow(i).getAddress();  // Get the address of the row\n            inputSheet.getRange(rowAddress).getEntireRow().delete(ExcelScript.DeleteShiftDirection.up);\n        }\n            \n        console.log(\"All rows have been cleared.\");\n    }\n    \n\n    // Add the input data as a new row in the table\n    table.addRow(-1, inputData);\n\n    console.log(`Row added to table: ${table.getName()}`);\n    inputSheet.getProtection().protect({\n                    allowInsertRows: true,  // Allow inserting rows\n                    allowInsertColumns: true,  // Allow inserting columns\n                    allowDeleteRows: true,  // Allow deleting rows\n                    allowDeleteColumns: true,  // Allow deleting columns\n                    allowFormatCells: true,  // Allow formatting cells\n                    allowFormatColumns: true,  // Allow formatting columns\n                    allowFormatRows: true  // Allow formatting rows\n                }, password);\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[{\"name\":\"password\",\"index\":0},{\"name\":\"clearAndAdd\",\"index\":1},{\"name\":\"inputData\",\"index\":2}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"password\",\"clearAndAdd\",\"inputData\"],\"properties\":{\"password\":{\"type\":\"string\"},\"clearAndAdd\":{\"type\":\"string\"},\"inputData\":{\"type\":\"array\",\"items\":{\"type\":\"string\"}}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"},{\"name\":\"password\",\"comment\":\"\"},{\"name\":\"clearAndAdd\",\"comment\":\"\"},{\"name\":\"inputData\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}